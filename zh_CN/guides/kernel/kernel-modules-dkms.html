

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Add kernel modules with DKMS &mdash; Documentation for Clear Linux* project</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'zh_CN',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Data Analytics Reference Stack" href="../stacks/dars.html" />
    <link rel="prev" title="Add kernel modules manually" href="kernel-modules.html" />

<link rel="stylesheet" href="../../_static/tcs_theme.css" type="text/css" />


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #007ab2" >
          

          
            <a href="../../index.html" class="icon icon-home"> Clear Linux* Project Docs
          

          
            
            <img src="../../_static/clearlinux.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Clear Linux</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Language Versions</dt>
        
          <dd><a href="/clearlinux/latest/guides/kernel/kernel-modules-dkms.html">English</a></dd>
        
          <dd><a href="/clearlinux/latest/zh_CN/guides/kernel/kernel-modules-dkms.html">Chinese</a></dd>
        
      </dl>
      <dl>
        <dt>Document Versions</dt>
        
          <dd><a href="/clearlinux/latest/guides/kernel/kernel-modules-dkms.html">latest</a></dd>
        
          <dd><a href="/clearlinux/L19.01/guides/kernel/kernel-modules-dkms.html">L19.01</a></dd>
        
      </dl>
      <dl>
        <dt>clearlinux.org links</dt>
          <dd>
            <a href="https://www.clearlinux.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/clearlinux/clear-linux-documentation">GitHub</a>
          </dd>
      </dl>
    </div>
  </div>
  
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/get-started.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tooling/tooling.html">How to Clear</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guides.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../guides.html#maintenance">Maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides.html#network">Network</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guides.html#kernel">Kernel</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="kernel-development.html">Kernel development</a></li>
<li class="toctree-l3"><a class="reference internal" href="kernel-modules.html">Add kernel modules manually</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Add kernel modules with DKMS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kernel-module-availability">Kernel module availability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-dkms">Install DKMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-install-and-load-an-out-of-tree-module">Build, install, and load an out-of-tree module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-topics">Related topics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides.html#stacks">Stacks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/faq.html">FAQ</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Clear Linux* Project Docs</a>
        
      </nav>


      <div class="wy-nav-content">

<header id="header">
  <div class="padding-md--left-right">

    <div class="header__site_info">
           <div class="header__site_info_name">
             <a href ="https://clearlinux.org"> Clear Linux* Project</a>
           </div>
    </div>
    <nav class="header__menu">
        <ul class="header__menu_list">
                         <li class="header__menu_list_item green  ">
                <a tabindex='1' href="https://clearlinux.org/about">About</a>
              </li>
                         <li class="header__menu_list_item purple  ">
                <a tabindex='1' href="https://clearlinux.org/developer">Developer</a>
              </li>
                         <li class="header__menu_list_item blue  ">
                <a tabindex='1' href="https://clearlinux.org/software">Software</a>
              </li>
        </ul>
    </nav>

  </div>



</header>


        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../guides.html">Guides</a> &raquo;</li>
        
      <li>Add kernel modules with DKMS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/clearlinux/clear-linux-documentation/blob/rtd-theme/source/guides/kernel/kernel-modules-dkms.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="add-kernel-modules-with-dkms">
<span id="kernel-modules-dkms"></span><h1>Add kernel modules with DKMS</h1>
<p>This guide describes how to add kernel modules with
<abbr title="Dynamic Kernel Module System">DKMS</abbr>.</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id2">Overview</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#kernel-module-availability" id="id4">Kernel module availability</a></li>
<li><a class="reference internal" href="#install-dkms" id="id5">Install DKMS</a></li>
<li><a class="reference internal" href="#build-install-and-load-an-out-of-tree-module" id="id6">Build, install, and load an out-of-tree module</a></li>
<li><a class="reference internal" href="#examples" id="id7">Examples</a></li>
<li><a class="reference internal" href="#related-topics" id="id8">Related topics</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a></h2>
<p>Certain kernel modules are enabled by default in Clear Linux* OS. To use additional
kernel modules that are not part of the Linux source tree, you may need to
build out-of-tree kernel modules. Use this guide to add kernel modules with
<abbr title="Dynamic Kernel Module System">DKMS</abbr> or refer to <a class="reference internal" href="kernel-modules.html#kernel-modules"><span class="std std-ref">Add kernel modules manually</span></a>.</p>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id1">Description</a></h2>
<p>Kernel modules are additional pieces of software capable of being inserted
into the Linux kernel to add functionality, such as a hardware driver.
Kernel modules may already be part of the Linux source tree (in-tree) or may
come from an external source, such as directly from a vendor (out-of-tree).</p>
<p><abbr title="Dynamic Kernel Module System">DKMS</abbr> is a framework that facilitates
the building and installation of kernel modules. DKMS allows Clear Linux OS to provide
hooks that automatically rebuild modules against new kernel versions.</p>
</div>
<div class="section" id="kernel-module-availability">
<h2><a class="toc-backref" href="#id1">Kernel module availability</a></h2>
<p>Clear Linux OS comes with many upstream kernel modules available for use. Using an
existing module is significantly easier to maintain and retains signature
verification of the Clear Linux OS kernel. For more information on Clear Linux OS security
practices, see the <a class="reference internal" href="../../tooling/security.html#security"><span class="std std-ref">OS Security</span></a> page.</p>
<p>Before continuing, check if the kernel module you’re looking for is already
available in Clear Linux OS or submit a request to add the module.</p>
<div class="section" id="check-if-the-module-is-already-available">
<h3>Check if the module is already available</h3>
<p>You can search for kernel module file names, which end with the <code class="file docutils literal notranslate"><span class="pre">.ko</span></code>
file extension, using the <strong class="command">swupd search</strong> command, as shown in the
following example. See <a class="reference internal" href="../../tooling/swupd-guide.html#swupd-guide"><span class="std std-ref">swupd</span></a> for more information.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd search <span class="si">${</span><span class="nv">module_name</span><span class="si">}</span>.ko
</pre></div>
</div>
</div>
<div class="section" id="submit-a-request-to-add-the-module">
<h3>Submit a request to add the module</h3>
<p>If the kernel module you need is already open source (for example, in the Linux
upstream) and likely to be useful to others, consider submitting a request to
add or enable it in the Clear Linux OS kernel.</p>
<p>Make enhancement requests to the Clear Linux OS ‘Distribution Project’_ on GitHub.</p>
</div>
</div>
<div class="section" id="install-dkms">
<h2><a class="toc-backref" href="#id1">Install DKMS</a></h2>
<p id="kernel-modules-dkms-install-begin">The <strong class="command">kernel-native-dkms</strong> bundle provides the <strong class="command">dkms</strong> program and
Linux kernel headers, which are required for compiling kernel modules.</p>
<p>The <strong class="command">kernel-native-dkms</strong> bundle also:</p>
<ul class="simple">
<li>Adds a <cite>systemd</cite> update trigger
(<code class="file docutils literal notranslate"><span class="pre">/usr/lib/systemd/system/dkms-new-kernel.service</span></code>) to automatically
run DKMS to rebuild modules after a kernel upgrade occurs with <a class="reference internal" href="../../tooling/swupd-guide.html#swupd-guide"><span class="std std-ref">swupd
update</span></a>.</li>
<li>Disables kernel module signature verification by appending a kernel
command-line parameter (<strong class="command">module.sig_unenforce</strong>) from the
<code class="file docutils literal notranslate"><span class="pre">/usr/share/kernel/cmdline.d/clr-ignore-mod-sig.conf</span></code> file.</li>
<li>Adds a notification to the Message of the Day (MOTD) indicating kernel
module signature verification is disabled.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">We recommend that you always review the <strong class="command">swupd update</strong> output
to make sure kernel modules were successfully rebuilt against the new
kernel. This is especially important for systems where a successful boot
relies on a kernel module.</p>
</div>
<p>Install the <strong class="command">kernel-native-dkms</strong> or <strong class="command">kernel-lts-dkms</strong>
bundle:</p>
<ol class="arabic">
<li><p class="first">Determine which kernel variant is running on Clear Linux OS. Only the <em>native</em>
and <em>lts</em> kernels are enabled to build and load out-of-tree kernel modules
with DKMS.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ uname -r
<span class="m">5</span>.XX.YY-ZZZZ.native
</pre></div>
</div>
<p>Ensure <em>.native</em> or <em>.lts</em> is in the kernel name.</p>
</li>
<li><p class="first">Install the DKMS bundle corresponding to the installed kernel. Use
<strong class="command">kernel-native-dkms</strong> for the native kernel or
<strong class="command">kernel-lts-dkms</strong> for the lts kernel.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd bundle-add kernel-native-dkms
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd bundle-add kernel-lts-dkms
</pre></div>
</div>
</li>
<li><p class="first">Update the Clear Linux OS bootloader and reboot.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo clr-boot-manager update
reboot
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="build-install-and-load-an-out-of-tree-module">
<span id="kernel-modules-dkms-install-end"></span><h2><a class="toc-backref" href="#id1">Build, install, and load an out-of-tree module</a></h2>
<p>Follow the steps in this section if you are an individual user or testing,
and you need an out-of-tree kernel module that is not available through
Clear Linux OS. For a more scalable and customizable approach, we recommend using
<a class="reference internal" href="../../tooling/mixer.html#mixer"><span class="std std-ref">mixer</span></a> to provide a custom kernel and updates.</p>
<div class="section" id="prerequisites">
<h3>Prerequisites</h3>
<p>Before you begin, you must:</p>
<ul class="simple">
<li>Disable Secure Boot in UEFI/BIOS. The loading of new out-of-tree modules
modifies the signatures that Secure Boot relies on for trust.</li>
<li>Obtain a kernel module package in the form of source code or
pre-compiled binaries.</li>
</ul>
</div>
<div class="section" id="obtain-kernel-module-source">
<h3>Obtain kernel module source</h3>
<p>A required <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file inside of the kernel module’s source code
directory informs DKMS how the kernel module should be compiled.</p>
<p>Kernel modules may come packaged as:</p>
<ul class="simple">
<li>Source code without a <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file</li>
<li>Source code with a premade <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file</li>
<li>Source code with a premade <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file and precompiled module
binaries</li>
<li>Precompiled module binaries only (without source code)</li>
</ul>
<p>Of the package types listed above, only precompiled kernel module binaries
will not work, because Clear Linux OS requires kernel modules to be built against the
same kernel source tree before they can be loaded. If you are only able to
obtain source code without a <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file, you must manually create
a <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file, described later in this document.</p>
<ol class="arabic">
<li><p class="first">Download the kernel module’s source code.</p>
<ul class="simple">
<li>Review the available download options. Some kernel modules provide
separate archives that are specifically enabled for DKMS support.</li>
<li>Review the README documentation, because it often provides required
information to build the module with DKMS support.</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -O http://&lt;URL-TO-KERNEL-MODULE-SOURCE&gt;.tar.gz
tar -xvf &lt;KERNEL-MODULE-SOURCE&gt;.tar.gz
<span class="nb">cd</span> &lt;KERNEL-MODULE-SOURCE&gt;/
cat README
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="build-kernel-module-with-an-existing-dkms-conf">
<h3>Build kernel module with an existing dkms.conf</h3>
<p>If the kernel module maintainer packaged the source archive with the
<strong class="command">dkms mktarball</strong> command, the entire archive can be passed to the
<strong class="command">dkms ldtarball</strong> which completes many steps for you.</p>
<p>The archive contains the required <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file, and may contain
a <code class="file docutils literal notranslate"><span class="pre">dkms_source_tree</span></code> directory and a <code class="file docutils literal notranslate"><span class="pre">dkms_binaries_only</span></code>
directory.</p>
<ol class="arabic">
<li><p class="first">Run the <strong class="command">dkms ldtarball</strong> command against the kernel
module archive.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dkms ldtarball &lt;KERNEL-MODULE-SOURCE_WITH_DKMS&gt;.tar.gz
</pre></div>
</div>
<p><strong class="command">dkms ldtarball</strong> places the kernel module source under
<code class="file docutils literal notranslate"><span class="pre">/usr/src/&lt;MODULE-NAME&gt;-&lt;MODULE-VERSION&gt;/</span></code>, builds it if necessary,
and adds the module into the DKMS tree.</p>
</li>
<li><p class="first">Verify the kernel module is detected by checking the output of the
<strong class="command">dkms status</strong> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dkms status
</pre></div>
</div>
</li>
<li><p class="first">Install the kernel module.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dkms install -m &lt;MODULE-NAME&gt; -v &lt;MODULE-VERSION&gt;
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="build-kernel-module-without-an-existing-dkms-conf">
<h3>Build kernel module without an existing dkms.conf</h3>
<p>If the kernel module source does not contain a <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file or the
<strong class="command">dkms ldtarball</strong> command encounters errors, you must manually
create the file.</p>
<p>Review the kernel module README documentation for guidance on what needs to be
in the <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file, including special variables that may be
required to build successfully.</p>
<p>Here are some additional resources that can be used for reference:</p>
<ul class="simple">
<li>DKMS manual page (<strong class="command">man dkms</strong>) shows detailed syntax in the
DKMS.CONF section.</li>
<li>Ubuntu community wiki entry for the <a class="reference external" href="https://help.ubuntu.com/community/Kernel/DkmsDriverPackage#Configure_DKMS">Kernel DKMS Package</a> shows an example
where a single package contains multiple modules.</li>
<li>Sample <a class="reference external" href="https://github.com/dell/dkms/blob/master/sample.conf">dkms.conf</a> file in the GitHub* repository for the DKMS project.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last"><strong class="command">AUTOINSTALL=yes</strong> must be set in the dkms.conf for the module to
be automatically recompiled with Clear Linux OS updates.</p>
</div>
<p>The instructions below show a generic example:</p>
<ol class="arabic">
<li><p class="first">Create or modify the <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file inside of the extracted source
code directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">$EDITOR</span> dkms.conf

<span class="nv">MAKE</span><span class="o">=</span><span class="s2">&quot;make -C src/ KERNELDIR=/lib/modules/</span><span class="si">${</span><span class="nv">kernelver</span><span class="si">}</span><span class="s2">/build&quot;</span>
<span class="nv">CLEAN</span><span class="o">=</span><span class="s2">&quot;make -C src/ clean&quot;</span>
<span class="nv">BUILT_MODULE_NAME</span><span class="o">=</span>custom_module
<span class="nv">BUILT_MODULE_LOCATION</span><span class="o">=</span>src/
<span class="nv">PACKAGE_NAME</span><span class="o">=</span>custom_module
<span class="nv">PACKAGE_VERSION</span><span class="o">=</span><span class="m">1</span>.0
<span class="nv">DEST_MODULE_LOCATION</span><span class="o">=</span>/kernel/drivers/other
<span class="nv">AUTOINSTALL</span><span class="o">=</span>yes
</pre></div>
</div>
<p>This example identifies a kernel module named <em>custom_module</em> with version
<em>1.0</em>.</p>
</li>
<li><p class="first">Copy the kernel module source code into the <code class="file docutils literal notranslate"><span class="pre">/usr/src/</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo mkdir /usr/src/&lt;PACKAGE_NAME&gt;-&lt;PACKAGE_VERSION&gt;
sudo cp -Rv . /usr/src/&lt;PACKAGE_NAME&gt;-&lt;PACKAGE_VERSION&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last"><em>&lt;PACKAGE_NAME&gt;</em> and <em>&lt;PACKAGE_VERSION&gt;</em> must match the entries in the
<code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file.</p>
</div>
</li>
<li><p class="first">Add the kernel module to the DKMS tree so that it is tracked by DKMS.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo dkms add -m &lt;MODULE-NAME&gt;
</pre></div>
</div>
</li>
<li><p class="first">Build the kernel module using DKMS. If the build encounters errors,
you may need to edit the <code class="file docutils literal notranslate"><span class="pre">dkms.conf</span></code> file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo dkms build -m &lt;MODULE-NAME&gt; -v &lt;MODULE-VERSION&gt;
</pre></div>
</div>
</li>
<li><p class="first">Install the kernel module using DKMS.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo dkms install -m &lt;MODULE-NAME&gt; -v &lt;MODULE-VERSION&gt;
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="load-kernel-module">
<h3>Load kernel module</h3>
<p>By default, DKMS installs modules “in-tree” under <code class="file docutils literal notranslate"><span class="pre">/lib/modules</span></code> so the
<strong class="command">modprobe</strong> command can be used to load them.</p>
<ol class="arabic">
<li><p class="first">Load the installed module with the <strong class="command">modprobe</strong> command.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo modprobe &lt;MODULE-NAME&gt;
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Validate the kernel module is loaded.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lsmod <span class="p">|</span> grep &lt;MODULE-NAME&gt;
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id1">Examples</a></h2>
<div class="section" id="optional-specify-module-options-and-aliases">
<h3>Optional: Specify module options and aliases</h3>
<p>Use the <strong class="command">modprobe</strong> command to load a module and set options.</p>
<p><strong class="command">modprobe</strong> may add or remove more than one module due to module
interdependencies. You can specify which options to use with individual modules,
by using configuration files under the <code class="file docutils literal notranslate"><span class="pre">/etc/modprobe.d</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo mkdir /etc/modprobe.d
</pre></div>
</div>
<p>All files underneath the <code class="file docutils literal notranslate"><span class="pre">/etc/modprobe.d</span></code> directory that end with the
<code class="file docutils literal notranslate"><span class="pre">.conf</span></code> extension specify module options to use when loading. You can use
<code class="file docutils literal notranslate"><span class="pre">.conf</span></code> files to create convenient aliases for modules or to override the
normal loading behavior altogether for those with special requirements.</p>
<p>Learn more about <strong class="command">modprobe</strong> on the modprobe.d manual page:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>man modprobe.d
</pre></div>
</div>
</div>
<div class="section" id="optional-configure-kernel-modules-to-load-at-boot">
<h3>Optional: Configure kernel modules to load at boot</h3>
<p>Use the <code class="file docutils literal notranslate"><span class="pre">/etc/modules-load.d</span></code> configuration directory to specify kernel
modules to load automatically at boot.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo mkdir /etc/modules-load.d
</pre></div>
</div>
<p>All files underneath the <code class="file docutils literal notranslate"><span class="pre">/etc/modules-load.d</span></code> directory that end with
the <code class="file docutils literal notranslate"><span class="pre">.conf</span></code> extension contain a list of module names of aliases (one per
line) to load at boot.</p>
<p>Learn more about module loading in the modules-load.d manual page:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>man modules-load.d
</pre></div>
</div>
</div>
</div>
<div class="section" id="related-topics">
<h2><a class="toc-backref" href="#id1">Related topics</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/dell/dkms">Dynamic Kernel Module System (DKMS)</a></li>
<li><a class="reference external" href="https://www.kernel.org/doc/ols/2004/ols2004v1-pages-187-202.pdf">Dell Linux Engineering Dynamic Kernel Module Support: From Theory to Practice</a></li>
<li><a class="reference external" href="https://www.linuxjournal.com/article/6896">Linux Journal: Exploring Dynamic Kernel Module Support</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../stacks/dars.html" class="btn btn-neutral float-right" title="Data Analytics Reference Stack" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="kernel-modules.html" class="btn btn-neutral float-left" title="Add kernel modules manually" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, many
      <span class="lastupdated">
        最后更新于 7月 25, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>


      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  

<script type="text/javascript" src="../../_static/tcs_theme.js"></script>



</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>swupd &mdash; Documentation for Clear Linux* project</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Telemetrics" href="../guides/telemetrics/telem-guide.html" />
    <link rel="prev" title="Stateless" href="stateless.html" />

<link rel="stylesheet" href="../_static/tcs_theme.css" type="text/css" />


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #007ab2" >
          

          
            <a href="../index.html" class="icon icon-home"> Clear Linux* Project Docs
          

          
            
            <img src="../_static/clearlinux.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Clear Linux</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Language Versions</dt>
        
          <dd><a href="/clearlinux/latest/tooling/swupd-guide.html">English</a></dd>
        
          <dd><a href="/clearlinux/latest/zh_CN/tooling/swupd-guide.html">Chinese</a></dd>
        
      </dl>
      <dl>
        <dt>Document Versions</dt>
        
          <dd><a href="/clearlinux/latest/tooling/swupd-guide.html">latest</a></dd>
        
          <dd><a href="/clearlinux/L19.01/tooling/swupd-guide.html">L19.01</a></dd>
        
      </dl>
      <dl>
        <dt>clearlinux.org links</dt>
          <dd>
            <a href="https://www.clearlinux.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/clearlinux/clear-linux-documentation">GitHub</a>
          </dd>
      </dl>
    </div>
  </div>
  
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started/get-started.html">Get started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tooling.html">How to Clear</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="autoproxy.html">Autoproxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="autospec.html">autospec</a></li>
<li class="toctree-l2"><a class="reference internal" href="compatible-kernels.html">Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="debug.html">Debug system</a></li>
<li class="toctree-l2"><a class="reference internal" href="ister.html">ister.py image builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixer.html">mixer</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">OS Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="stateless.html">Stateless</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">swupd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#versioning">Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating">Updating</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it works</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updates">Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bundle-search">Bundle search</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-1-disable-and-enable-automatic-updates">Example 1: Disable and enable automatic updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-2-find-and-install-kata-containers">Example 2: Find and install Kata Containers*</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-3-verify-and-correct-system-file-mismatch">Example 3: Verify and correct system file mismatch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quick-reference">Quick reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-topics">Related topics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/telemetrics/telem-guide.html">Telemetrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tooling.html#training">Training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/guides.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ/faq.html">FAQ</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Clear Linux* Project Docs</a>
        
      </nav>


      <div class="wy-nav-content">

<header id="header">
  <div class="padding-md--left-right">

    <div class="header__site_info">
           <div class="header__site_info_name">
             <a href ="https://clearlinux.org"> Clear Linux* Project</a>
           </div>
    </div>
    <nav class="header__menu">
        <ul class="header__menu_list">
                         <li class="header__menu_list_item green  ">
                <a tabindex='1' href="https://clearlinux.org/about">About</a>
              </li>
                         <li class="header__menu_list_item purple  ">
                <a tabindex='1' href="https://clearlinux.org/developer">Developer</a>
              </li>
                         <li class="header__menu_list_item blue  ">
                <a tabindex='1' href="https://clearlinux.org/software">Software</a>
              </li>
        </ul>
    </nav>

  </div>



</header>


        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="tooling.html">How to Clear</a> &raquo;</li>
        
      <li>swupd</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/clearlinux/clear-linux-documentation/blob/rtd-theme/source/tooling/swupd-guide.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="swupd">
<span id="swupd-guide"></span><h1>swupd</h1>
<p><strong class="command">swupd</strong> links a Clear Linux* OS installation with upstream updates and
software.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#description" id="id1">Description</a></li>
<li><a class="reference internal" href="#how-it-works" id="id2">How it works</a></li>
<li><a class="reference internal" href="#examples" id="id3">Examples</a></li>
<li><a class="reference internal" href="#quick-reference" id="id4">Quick reference</a></li>
<li><a class="reference internal" href="#related-topics" id="id5">Related topics</a></li>
</ul>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id1">Description</a></h2>
<p><strong class="command">swupd</strong> has two main functions:</p>
<ol class="arabic simple">
<li>Manage software and replace APT or YUM, by installing bundles
rather than packages.</li>
<li>Check for system updates and install them.</li>
</ol>
<p><strong class="command">swupd</strong> manages overlapping dependencies behind the scenes, ensuring
that all software is compatible across the system. It can be used to verify
the OS, clean cached files, and fix issues.</p>
<p><a class="reference internal" href="../reference/bundles/bundles.html#bundles"><span class="std std-ref">Bundles</span></a> contain everything needed to deliver a software
capability. They are the smallest granularity component that is
managed by Clear Linux OS. A bundle comes with all of its dependencies rather than
downloading a cascade of package dependencies when installing a piece of
software.</p>
<div class="section" id="versioning">
<h3>Versioning</h3>
<p>Using package managers to monitor software version compatibility or
compare multiple systems on many Linux distributions can be cumbersome.</p>
<p>With Clear Linux OS <strong class="command">swupd</strong>, versioning happens at the individual file level.
This means Clear Linux OS generates an entirely new OS version with any set of software
changes to the system, including software downgrades or removals. This
rolling release versioning model is similar to <strong class="command">git</strong> internal version
tracking, where any of the individual file commits are tracked and move the
pointer forward when changed.</p>
<p>A number that represents the <strong>current</strong> release of the OS describes the
versions of all the software on the OS. Each build is composed of a specific
set of bundles made from a particular version of packages. On a daily basis,
this matters to system administrators who need to determine which of their
systems do not have the latest security fixes, or which combinations of
software have been tested. Every release of the same number is guaranteed to
contain the same versions of software, so there’s no ambiguity between two
systems running the same version of Clear Linux OS.</p>
</div>
<div class="section" id="updating">
<h3>Updating</h3>
<p>Clear Linux OS enforces regular updating of the OS by default and automatically
checks for updates against a version server. The content server provides the
file and metadata content for all versions and can be the same as the
version server. The content url server provides metadata in the form of
<em>manifests</em>, which list and describe file contents, symlinks,
and directories. Additionally, the actual content is provided to clients
in the form of archive files.</p>
<p>Software updates with Clear Linux OS are also efficient. Unlike package-based
distributions, <strong class="command">swupd</strong> only updates files that have changed, rather
than entire packages. For example, it is quite common for an OS security
patch to be as small as 15 KB. Using binary deltas, Clear Linux OS is able to
apply only what is needed.</p>
<p>For details on how to generate update content for Clear Linux OS, see the
<a class="reference internal" href="mixer.html#mixer"><span class="std std-ref">mixer</span></a> tool.</p>
</div>
</div>
<div class="section" id="how-it-works">
<h2><a class="toc-backref" href="#id2">How it works</a></h2>
<div class="section" id="prerequisites">
<h3>Prerequisites</h3>
<ul class="simple">
<li>The device is on a well-connected network.</li>
<li>The device is able to connect to an update server. The default server is:
<a class="reference external" href="http://update.clearlinux.org">http://update.clearlinux.org</a></li>
</ul>
</div>
<div class="section" id="updates">
<h3>Updates</h3>
<p>Clear Linux OS updates are automatic by default, but can be set to occur only on
demand. <strong class="command">swupd</strong> makes sure that regular updates are simple and
secure. It can also check the validity of currently installed files and
software, and can correct any problems.</p>
<div class="section" id="manifests">
<h4>Manifests</h4>
<p>The Clear Linux OS software update content consists of data and metadata. The data is
the files that end up in the OS. The metadata contains relevant information to
properly provision the data to the OS file system, as well as update the
system and add or remove additional content to the OS.</p>
<p>The manifests are mostly long lists of hashes that describe content.
Each bundle gets its own manifest file. There is a master manifest
file that describes all manifests to tie it all together.</p>
</div>
<div class="section" id="fullfiles-packs-and-delta-packs">
<h4>Fullfiles, packs, and delta packs</h4>
<p>To speed up updates and optimize content delivery, update data provisioned to
a system is obtained by one of the following methods:</p>
<ul class="simple">
<li><em>Fullfiles</em> are always generated for every file in every release. This
allows any Clear Linux OS to obtain the exact copy of the content
for each version directly. This is used if the OS verification
needs to replace a single file, for instance.</li>
<li><em>Packs</em> are available for some releases. They combine many files to speed
up the creation of installation media and large updates.</li>
<li><em>Delta packs</em> are an optimized version of packs that only contain updates
(binary diffs). They cannot be used without having the original file content.</li>
</ul>
</div>
</div>
<div class="section" id="bundle-search">
<h3>Bundle search</h3>
<p><strong class="command">swupd</strong> searches download manifest data for
bundles that match the term. Enter only one term, or hyphenated term, per
search. Use the command <strong class="command">man swupd</strong> to learn more.</p>
<p>Only the base bundle is returned. Bundles can contain other bundles via
includes. For more details, see <a class="reference external" href="https://github.com/clearlinux/clr-bundles">Bundle Definition Files</a> and its
subdirectory bundles.</p>
<p>Bundles that are already installed are marked <strong>(installed)</strong> in search
results.</p>
<p>Optionally, you can review our <a class="reference external" href="https://github.com/clearlinux/clr-bundles/tree/master/bundles">bundles</a> on GitHub*.</p>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id3">Examples</a></h2>
<div class="section" id="example-1-disable-and-enable-automatic-updates">
<h3>Example 1: Disable and enable automatic updates</h3>
<p>Clear Linux OS updates are automatic by default, but can be set to occur only
on demand.</p>
<ol class="arabic">
<li><p class="first">Verify your current auto-update setting.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd autoupdate
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Enabled</span>
</pre></div>
</div>
</li>
<li><p class="first">Disable automatic updates.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd autoupdate --disable
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Warning: disabling automatic updates may take you out of compliance with your IT policy</span>

<span class="go">Running systemctl to disable updates</span>
<span class="go">Created symlink /etc/systemd/system/swupd-update.service → /dev/null.</span>
<span class="go">Created symlink /etc/systemd/system/swupd-update.timer → /dev/null.</span>
</pre></div>
</div>
</li>
<li><p class="first">Check manually for updates.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd check-update
</pre></div>
</div>
</li>
<li><p class="first">Install an update after identifying one that you need.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd update --version &lt;version number&gt;
</pre></div>
</div>
</li>
<li><p class="first">Re-enable automatic installs.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd autoupdate --enable
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="example-2-find-and-install-kata-containers">
<span id="swupd-guide-example-install-bundle"></span><h3>Example 2: Find and install Kata Containers*</h3>
<p>Kata Containers is a popular container implementation. Unlike other
container implementations, each Kata Container has its own
kernel instance and runs on its own <abbr title="Virtual Machine">VM</abbr> for
improved security.</p>
<p>Clear Linux OS makes it very easy to install, since you only need to add
one bundle to use <a class="reference external" href="https://clearlinux.org/downloads/containers">Kata Containers</a>: <a class="reference external" href="https://github.com/clearlinux/clr-bundles/blob/master/bundles/containers-virt">containers-virt</a>, despite a
number of dependencies.  Also, check out our tutorial: <a class="reference internal" href="../tutorials/kata.html#kata"><span class="std std-ref">Install Kata Containers*</span></a>.</p>
<ol class="arabic">
<li><p class="first">Find the correct bundle.</p>
<p>To return all possible matches for the search string, enter
<strong class="command">swupd search</strong>, followed by ‘kata’:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd search kata
</pre></div>
</div>
<p>The output should be similar to:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Bundle with the best search result:</span>

<span class="go">     containers-virt - Run container applications from Dockerhub in lightweight virtual machines</span>

<span class="go">This bundle can be installed with:</span>

<span class="go">     swupd bundle-add  containers-virt</span>

<span class="go">Alternative bundle options are</span>

<span class="go">     cloud-native-basic - Contains ClearLinux native software for Cloud</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your search does not produce results with a specific term, shorten
the search term. For example, use <em>kube</em> instead of <em>kubernetes</em>.</p>
</div>
</li>
<li><p class="first">Add the bundle.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd bundle-add containers-virt
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To add multiple bundles, add a space followed by the bundle name.</p>
</div>
<p>The output of a successful installation should be similar to:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Downloading packs...</span>

<span class="go">Extracting containers-virt pack for version 24430</span>
<span class="go">    ...50%</span>
<span class="go">Extracting kernel-container pack for version 24430</span>
<span class="go">    ...100%</span>
<span class="go">Starting download of remaining update content. This may take a while...</span>
<span class="go">    ...100%</span>
<span class="go">Finishing download of update content...</span>
<span class="go">Installing bundle(s) files...</span>
<span class="go">    ...100%</span>
<span class="go">Calling post-update helper scripts.</span>
<span class="go">Successfully installed 1 bundle</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="example-3-verify-and-correct-system-file-mismatch">
<h3>Example 3: Verify and correct system file mismatch</h3>
<p><strong class="command">swupd</strong> can determine whether system directories and files have
been added to, overwritten, removed, or modified (e.g., permissions).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd diagnose
</pre></div>
</div>
<p>All directories that are watched by <strong class="command">swupd</strong> are verified according
to the manifest data. Hash mismatches are flagged as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Verifying version 23300</span>
<span class="go">Verifying files</span>
<span class="go">   ...0%</span>
<span class="go">Hash mismatch for file: /usr/bin/chardetect</span>
<span class="go">...</span>
<span class="go">...</span>
<span class="go">Hash mismatch for file: /usr/lib/python3.6/site-packages/urllib3/util/wait.py</span>
<span class="go">   ...100%</span>
<span class="go">Inspected 237180 files</span>
<span class="go">   423 files did not match</span>
<span class="go">Verify successful</span>
</pre></div>
</div>
<p>In this case, Python* packages that were installed on top of the default
install were flagged as mismatched. <strong class="command">swupd</strong> can be directed to
ignore or fix issues based on command line options.</p>
<p><strong class="command">swupd</strong> can correct any issues it detects. Additional directives
can be added including a white list of directories to be ignored.</p>
<p>The following command repairs issues, removes unknown items, and
ignores files or directories matching <code class="file docutils literal notranslate"><span class="pre">/usr/lib/python</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo swupd repair --picky --picky-whitelist<span class="o">=</span>/usr/lib/python
</pre></div>
</div>
</div>
</div>
<div class="section" id="quick-reference">
<h2><a class="toc-backref" href="#id4">Quick reference</a></h2>
<dl class="docutils">
<dt>swupd info</dt>
<dd>Returns the currently installed version and update servers.</dd>
<dt>swupd update &lt;version number&gt;</dt>
<dd>Updates to a specific version or updates to latest version if no
arguments are used.</dd>
<dt>swupd bundle-list [–all]</dt>
<dd>Lists installed bundles.</dd>
<dt>swupd bundle-add [-b] &lt;search term&gt;</dt>
<dd>Finds a bundle that contains your search term.</dd>
<dt>swupd bundle-add &lt;bundle name&gt;</dt>
<dd>Adds a bundle.</dd>
<dt>swupd bundle-remove &lt;bundle name&gt;</dt>
<dd>Removes a bundle.</dd>
<dt>swupd –help</dt>
<dd>Lists additional <strong class="command">swupd</strong> commands.</dd>
<dt>man swupd</dt>
<dd>Opens the <strong class="command">swupd</strong> man page.</dd>
</dl>
<p>Refer to <a class="reference external" href="https://github.com/clearlinux/swupd-client/blob/master/docs/swupd.1.rst">swupd source documentation</a> on GitHub for more details.</p>
</div>
<div class="section" id="related-topics">
<h2><a class="toc-backref" href="#id5">Related topics</a></h2>
<ul class="simple">
<li><a class="reference internal" href="autospec.html#autospec"><span class="std std-ref">autospec</span></a></li>
<li><a class="reference internal" href="mixer.html#mixer"><span class="std std-ref">mixer</span></a></li>
<li><a class="reference internal" href="../reference/bundles/bundles.html#bundles"><span class="std std-ref">Available bundles</span></a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../guides/telemetrics/telem-guide.html" class="btn btn-neutral float-right" title="Telemetrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="stateless.html" class="btn btn-neutral float-left" title="Stateless" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, many
      <span class="lastupdated">
        Last updated on Jul 25, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>


      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  

<script type="text/javascript" src="../_static/tcs_theme.js"></script>



</body>
</html>